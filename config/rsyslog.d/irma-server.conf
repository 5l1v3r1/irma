#### MODULES ####

$ModLoad imtcp # provides TCP syslog reception
$InputTCPServerRun 10514


#### DIRECTIVES ####

$FileOwner root
$FileGroup root
$FileCreateMode 0640
$DirCreateMode 0755


####Â RULES ####

# log remote clients to different directories
# directories must be created first, and owned by syslog:syslog
$template FILENAME_BRAIN,    "/var/log/irma/brain/%hostname%/%syslogfacility-text%.log"
$template FILENAME_PROBE,    "/var/log/irma/probe/%hostname%/%syslogfacility-text%.log"
$template FILENAME_FRONTEND, "/var/log/irma/frontend/%hostname%/%syslogfacility-text%.log"

:programname, startswith, "irma-probe" ?FILENAME_PROBE
:programname, startswith, "irma-probe" ~

:programname, startswith, "irma-brain" ?FILENAME_BRAIN
:programname, startswith, "irma-brain" ~

:programname, startswith, "irma-frontend" ?FILENAME_FRONTEND
:programname, startswith, "irma-frontend" ~
